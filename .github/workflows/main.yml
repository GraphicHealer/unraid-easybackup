name: Create TXZ on Release and Upload to Archive
on:
  release:
    types: [published]

jobs:
  releaseTxz:
    name: Create Release Txz
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Set output
        id: vars
        run: |
          echo "tag=${GITHUB_REF#refs/*/}" >> $GITHUB_OUTPUT
          echo "repo=${GITHUB_REPOSITORY#$GITHUB_REPOSITORY_OWNER/}" >> $GITHUB_OUTPUT
      - name: Add Release to .plg file
        env:
          RELEASE_VERSION: ${{ steps.vars.outputs.tag }}
          GITHUB_REPO: ${{ steps.vars.outputs.repo }}
        run: |
          sed -i "s/<!ENTITY version \".*\">/<!ENTITY version \"$RELEASE_VERSION\">/"

      # - name: Zip Folder
      #   run: |
      #     cd ../
      #     zip -r <repository_name>.zip <repository_name> -x ".git/*" ".github/*"
